import{m as C,F as P,r as F,u as w,a as T,b as v,d as I,o as x,e as d,f as k,c as r,g,A as D,h as M,W as V,w as j,X as K,t as E,B as q,C as z,x as H}from"./index-DYztBfRV.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as L,a as W}from"./index-BIV3kDU7.js";const X={__name:"createFolderModel",props:C({parentFolderId:{type:[String,Number],default:""},folderName:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:C(["update:update"],["update:modelValue"]),setup(m,{emit:N}){const t=P.useForm,n=F(!1),l=w(m,"modelValue"),_=N,y=m,s=T({folderName:y.folderName}),o=T({folderName:[{required:!0,message:"请填写"}]}),{resetFields:i,validate:u,validateInfos:e}=t(s,o);F("");const{copy:a}=L({legacy:!0}),b=()=>{n.value=!0,u().then(()=>{console.log(s),console.log(" parentFolderId>>>",y.parentFolderId),D.createFolder({...s,parentFolderId:y.parentFolderId}).then(f=>{console.log("🚀 ~ API.renameFolder ~ res:",f),!y.folderName&&a(f.id).then(()=>{M.success("复制成功, 文件夹ID: "+f.id)}).catch(p=>{M.error("复制失败")}),M.success("创建成功"),_("update",f),l.value=!1}).finally(()=>{n.value=!1})}).catch(f=>{console.log("error",f),n.value=!1})},R=()=>{l.value=!1},c=f=>{console.log("Failed:",f)};return(f,p)=>{const U=v("a-input"),$=v("a-form-item"),A=v("a-form"),S=v("a-button"),B=v("a-modal");return x(),I(B,{open:l.value,"onUpdate:open":p[1]||(p[1]=h=>l.value=h),title:"新建文件夹"},{footer:d(()=>[r(S,{key:"back",onClick:R},{default:d(()=>p[2]||(p[2]=[g("取消")])),_:1}),r(S,{key:"submit",type:"primary",loading:n.value,onClick:b},{default:d(()=>p[3]||(p[3]=[g("确认")])),_:1},8,["loading"])]),default:d(()=>[k("div",null,[r(A,{model:s,name:"basic","label-col":{span:4},"wrapper-col":{span:16},autocomplete:"off",onFinish:b,onFinishFailed:c},{default:d(()=>[r($,{label:"文件名",name:"folderName"},{default:d(()=>[r(U,{value:s.folderName,"onUpdate:value":p[0]||(p[0]=h=>s.folderName=h)},null,8,["value"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["open"])}}},G={__name:"FolderTree",props:C(K(["breadcrumb"],{breadcrumb:()=>[V]}),{modelValue:{default:()=>V},modelModifiers:{}}),emits:["update:modelValue"],setup(m){const N=m.breadcrumb.map(o=>o.id),t=F(N),n=F([V]),l=w(m,"modelValue");function _(o){const i=o.dataRef;return D.getObjectFolderNodes({id:i.id,Cookie:document.cookie,noCache:Math.random()}).then(u=>{o.dataRef.children=u.map(e=>({...e,fullIds:[...i.fullIds,e.id],fullNames:[...i.fullNames,e.name]}))}).catch(u=>{o.dataRef.children=[]})}function y(o,{selected:i,selectedNodes:u,node:e,event:a}){console.log("selectedNodes>>>",e),l.value.id!==e.id&&(l.value=e),t.value.includes(e.id)?t.value=t.value.filter(b=>b!==e.id):t.value=[...t.value,e.id]}j(l,o=>{t.value=[...t.value,o]});function s(o,{expanded:i,node:u}){t.value=[...o]}return(o,i)=>{const u=v("a-directory-tree"),e=v("a-card");return x(),I(e,{class:"folder-tree"},{default:d(()=>[r(u,{expandedKeys:t.value,selectedKeys:[l.value.id],fieldNames:{children:"children",title:"name",key:"id"},"load-data":_,"tree-data":n.value,onExpand:s,onSelect:y},null,8,["expandedKeys","selectedKeys","tree-data"])]),_:1})}}},J=O(G,[["__scopeId","data-v-123c839f"]]),Q={class:"footer-btn"},Y={__name:"FolderTreeModel",props:C(K(["breadcrumb","taskName"],{breadcrumb:()=>[V],taskName:""}),{modelValue:{default:!1},modelModifiers:{}}),emits:C(["ok"],["update:modelValue"]),setup(m,{emit:N}){const t=N,n=w(m,"modelValue"),l=F(V),_=F(!1),y=e=>{console.log("selectRow>>>>",l.value),n.value=!1,t("ok",l.value)},s=F(null),o=F(null),i=W(o,s),u=e=>{_.value=!1,n.value=!1,t("ok",e)};return(e,a)=>{const b=v("a-button"),R=v("a-modal");return x(),I(R,{open:n.value,"wrap-style":{overflow:"hidden"},class:"ant-modal-dray"},{title:d(()=>[k("div",{ref_key:"modalTitleRef",ref:s,class:"modal-title",style:{width:"100%",cursor:"move"}},"分享目录选择",512)]),modalRender:d(({originVNode:c})=>[k("div",{ref_key:"modalRef",ref:o,style:z(H(i))},[(x(),I(q(c)))],4)]),footer:d(()=>[k("div",Q,[r(b,{type:"primary",onClick:a[1]||(a[1]=c=>_.value=!0)},{default:d(()=>a[4]||(a[4]=[g("新建文件夹")])),_:1}),k("div",null,[r(b,{onClick:a[2]||(a[2]=c=>n.value=!1)},{default:d(()=>a[5]||(a[5]=[g("取消")])),_:1}),r(b,{type:"primary",onClick:y},{default:d(()=>a[6]||(a[6]=[g("确定")])),_:1})])])]),default:d(()=>[r(J,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=c=>l.value=c),breadcrumb:m.breadcrumb},null,8,["modelValue","breadcrumb"]),k("div",null,"选中路径："+E(l.value.fullNames.join(" / ")),1),r(X,{modelValue:_.value,"onUpdate:modelValue":a[3]||(a[3]=c=>_.value=c),parentFolderId:l.value.id,onUpdate:u,folderName:m.taskName},null,8,["modelValue","parentFolderId","folderName"])]),_:1},8,["open"])}}},le=O(Y,[["__scopeId","data-v-d5a2b082"]]);export{le as F,X as _};
