import{c as o,I as ee,m as L,r as m,u as Q,q as F,a as W,d as C,o as r,e as t,j as D,l as te,x as i,k as P,b as p,f as U,g as c,P as X,B as Y,C as Z,n as O,A as E,h as z,E as ae,v as oe,t as N,y as le,M as ne,G as se}from"./index-CBYdP0Oa.js";import{a as K}from"./index-CHE2aRta.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useDayjs-B1OV81JK.js";import{u as ue}from"./CloudDisk-rlGlq4se.js";import{h as re}from"./index-CbH7X_L3.js";var de={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"};function J(v){for(var n=1;n<arguments.length;n++){var l=arguments[n]!=null?Object(arguments[n]):{},g=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(g=g.concat(Object.getOwnPropertySymbols(l).filter(function(x){return Object.getOwnPropertyDescriptor(l,x).enumerable}))),g.forEach(function(x){ce(v,x,l[x])})}return v}function ce(v,n,l){return n in v?Object.defineProperty(v,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):v[n]=l,v}var H=function(n,l){var g=J({},n,l.attrs);return o(ee,J({},g,{icon:de}),null)};H.displayName="MinusCircleOutlined";H.inheritAttrs=!1;const ie={__name:"AddAccModel",props:{modelValue:{},modelModifiers:{}},emits:L(["update"],["update:modelValue"]),setup(v,{emit:n}){const l=m(null),g=m(null),x=K(g,l),y=Q(v,"modelValue"),B=n,f=m(!1),S=m();F(()=>{});let _=W({domains:[{account:"",password:""}]});const k=()=>{_.domains.push({account:"",password:""})},M=s=>{const d=_.domains.indexOf(s);d!==-1&&_.domains.splice(d,1)},b=()=>{f.value=!0,S.value.validate().then(async()=>{E.BatchUpdate({list:_.domains}).then(s=>{z.success("保存成功"),_.domains=[{account:"",password:""}],y.value=!1,B("update")}).finally(()=>{f.value=!1})}).catch(s=>{console.log("error",s),f.value=!1})},A=()=>{y.value=!1};return(s,d)=>{const I=p("a-input"),a=p("a-form-item"),e=p("a-col"),h=p("a-row"),w=p("a-form"),R=p("a-button"),T=p("a-modal");return r(),C(T,{maskClosable:!1,open:y.value,class:"ant-modal-dray",onCancel:A,width:"650px"},{title:t(()=>[U("div",{ref_key:"modalTitleRef",ref:l,class:"modal-title",style:{width:"100%",cursor:"move"}}," 添加云盘账号 ",512)]),modalRender:t(({originVNode:u})=>[U("div",{ref_key:"modalRef",ref:g,style:Z(i(x))},[(r(),C(Y(u)))],4)]),footer:t(()=>[o(R,{type:"dashed",onClick:k},{default:t(()=>[o(i(X)),d[0]||(d[0]=c(" 添加云盘账号 "))]),_:1}),U("div",null,[o(R,{key:"back",onClick:A},{default:t(()=>d[1]||(d[1]=[c("取消")])),_:1}),o(R,{key:"submit",loading:f.value,type:"primary",onClick:b},{default:t(()=>d[2]||(d[2]=[c("保存")])),_:1},8,["loading"])])]),default:t(()=>[o(w,{ref_key:"formRef",ref:S,model:i(_)},{default:t(()=>[(r(!0),D(P,null,te(i(_).domains,(u,V)=>(r(),C(h,{key:u.key},{default:t(()=>[o(e,{span:11},{default:t(()=>[o(a,{label:"账号",name:["domains",V,"account"],rules:{required:!0,message:"请输入云盘账号",trigger:"change"}},{default:t(()=>[o(I,{value:u.account,"onUpdate:value":$=>u.account=$,placeholder:"请输入云盘账号",style:{width:"150px","margin-right":"8px"}},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),o(e,{span:10},{default:t(()=>[o(a,{label:"密码",name:["domains",V,"password"],rules:{required:!0,message:"请输入云盘密码",trigger:"change"}},{default:t(()=>[o(I,{value:u.password,"onUpdate:value":$=>u.password=$,placeholder:"请输入云盘密码",style:{width:"150px","margin-right":"8px"},type:"password"},null,8,["value","onUpdate:value"]),i(_).domains.length>1?(r(),C(i(H),{key:0,class:"dynamic-delete-button",onClick:$=>M(u)},null,8,["onClick"])):O("",!0)]),_:2},1032,["name"])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["model"])]),_:1},8,["open"])}}},me=G(ie,[["__scopeId","data-v-b475bf39"]]),pe={__name:"EditAccModel",props:L({account:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:L(["update"],["update:modelValue"]),setup(v,{emit:n}){const l=m(null),g=m(null),x=K(g,l),y=Q(v,"modelValue"),B=n,f=v,S=m(!1),_=m();F(()=>{});let k=W({account:f.account,password:"",cookies:""});const M=()=>{S.value=!0,_.value.validate().then(async()=>{E.BatchUpdate({list:[k]}).then(A=>{z.success("保存成功"),y.value=!1,B("update",{account:f.account,cookies:k.cookies}),k={account:"",password:"",cookies:""}}).finally(()=>{S.value=!1})}).catch(A=>{console.log("error",A),S.value=!1})},b=()=>{y.value=!1};return(A,s)=>{const d=p("a-input"),I=p("a-form-item"),a=p("a-form"),e=p("a-button"),h=p("a-modal");return r(),C(h,{maskClosable:!1,open:y.value,class:"ant-modal-dray",onCancel:b,width:"500px"},{title:t(()=>[U("div",{ref_key:"modalTitleRef",ref:l,class:"modal-title",style:{width:"100%",cursor:"move"}},"编辑云盘账号",512)]),modalRender:t(({originVNode:w})=>[U("div",{ref_key:"modalRef",ref:g,style:Z(i(x))},[(r(),C(Y(w)))],4)]),footer:t(()=>[o(e,{key:"back",onClick:b},{default:t(()=>s[3]||(s[3]=[c("取消")])),_:1}),o(e,{key:"submit",loading:S.value,type:"primary",onClick:M},{default:t(()=>s[4]||(s[4]=[c("保存")])),_:1},8,["loading"])]),default:t(()=>[o(a,{ref_key:"formRef",ref:_,model:i(k)},{default:t(()=>[o(I,{label:"账号",name:"account",rules:{required:!0,message:"请输入云盘账号",trigger:"change"}},{default:t(()=>[o(d,{value:i(k).account,"onUpdate:value":s[0]||(s[0]=w=>i(k).account=w),placeholder:"请输入云盘账号",disabled:"",style:{width:"150px","margin-right":"8px"}},null,8,["value"])]),_:1}),o(I,{label:"密码",name:"password",rules:{required:!0,message:"请输入云盘密码",trigger:"change"}},{default:t(()=>[o(d,{value:i(k).password,"onUpdate:value":s[1]||(s[1]=w=>i(k).password=w),placeholder:"请输入云盘密码",style:{width:"150px","margin-right":"8px"},type:"password"},null,8,["value"])]),_:1}),o(I,{label:"cookies",name:"cookies",rules:{required:!0,message:"请输入云盘cookies",trigger:"change"}},{default:t(()=>[o(d,{value:i(k).cookies,"onUpdate:value":s[2]||(s[2]=w=>i(k).cookies=w),placeholder:"请输入云盘cookies",style:{width:"350px","margin-right":"8px"}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])}}},fe=G(pe,[["__scopeId","data-v-ef4961ac"]]),ve={class:"app-container"},ge={class:"table-top"},_e={__name:"index",setup(v){const n=m(!1),l=m(!1),g=m(""),x=ue(),y=m(window.localStorage.getItem("account")),B=a=>{g.value=a.account,l.value=!0},f=m(!1),S=a=>{ne.confirm({title:"删除确认",icon:o(se),content:o("div",{style:"color:red;"},`是否要删除账号： ${a} ？`),okText:"删除",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk(){return f.value=!0,E.BatchDelete({list:[a]}).then(e=>{z.success("删除成功"),y.value==a&&(y.value="",window.localStorage.setItem("account",""),window.sessionStorage.setItem("cloud","")),b()}).catch(e=>{f.value=!1})},onCancel(){}})},_=m([]),k=m([{title:"序号",dataIndex:"serial"},{title:"账号",dataIndex:"account"},{title:"是否登录",dataIndex:"login"},{title:"更新时间",dataIndex:"update_time"},{title:"操作",dataIndex:"operate"}]),M=m({current:1,pageSize:1e3,total:0,showTotal:a=>`共计 ${a} 条`}),b=()=>{f.value=!0,E.getAccountList().then(a=>{a.length==1&&!a[0].cookies&&d(a[0].account),_.value=a,M.value.total=a.length}).finally(()=>{f.value=!1})},A=a=>{a.account==y.value&&I(a),b()},s=a=>{window.sessionStorage.setItem("cloud",a.cookies||""),window.localStorage.setItem("account",a.account),y.value=a.account,x.setCloudDiskUserInfo({account:a.account})},d=a=>{f.value=!0,E.cloudLogin({account:a}).then(e=>{s(e),z.success("登陆成功"),ae(()=>{b()})}).finally(()=>{f.value=!1})},I=a=>{console.log("🚀 ~ onSelect ~ res:",a),a.cookies?(s(a),z.success("切换成功")):d(a.account)};return F(()=>{b()}),(a,e)=>{const h=p("a-button"),w=p("a-space"),R=p("a-tag"),T=p("a-table");return r(),D("div",ve,[U("div",ge,[e[5]||(e[5]=U("div",null,null,-1)),o(w,null,{default:t(()=>[o(h,{type:"primary",onClick:b},{default:t(()=>e[3]||(e[3]=[c("刷新")])),_:1}),o(h,{icon:oe(i(X)),type:"primary",onClick:e[0]||(e[0]=u=>n.value=!0)},{default:t(()=>e[4]||(e[4]=[c("新增账号")])),_:1},8,["icon"])]),_:1})]),o(T,{columns:k.value,dataSource:_.value,loading:f.value,pagination:M.value},{bodyCell:t(({column:u,record:V,index:$,text:j})=>[u.dataIndex==="account"?(r(),D(P,{key:0},[c(N(i(re)(j))+" ",1),j==y.value?(r(),C(R,{key:0,color:"green"},{default:t(()=>e[6]||(e[6]=[c("当前")])),_:1})):O("",!0)],64)):O("",!0),u.dataIndex==="serial"?(r(),D(P,{key:1},[c(N((M.value.current-1)*M.value.pageSize+$+1),1)],64)):O("",!0),u.dataIndex==="login"?(r(),D(P,{key:2},[V.cookies?(r(),C(R,{key:0,color:"green"},{default:t(()=>e[7]||(e[7]=[c("已登录")])),_:1})):(r(),C(R,{key:1,color:"red"},{default:t(()=>e[8]||(e[8]=[c("未登录")])),_:1}))],64)):O("",!0),u.dataIndex==="update_time"?(r(),D(P,{key:3},[c(N(i(le)(j).fromNow()),1)],64)):O("",!0),u.dataIndex==="operate"?(r(),C(w,{key:4},{default:t(()=>[o(h,{onClick:q=>I(V)},{default:t(()=>e[9]||(e[9]=[c("切换")])),_:2},1032,["onClick"]),o(h,{onClick:q=>d(V.account)},{default:t(()=>e[10]||(e[10]=[c("登陆")])),_:2},1032,["onClick"]),o(h,{onClick:q=>B(V)},{default:t(()=>e[11]||(e[11]=[c("编辑")])),_:2},1032,["onClick"]),o(h,{onClick:q=>S(V.account)},{default:t(()=>e[12]||(e[12]=[c("删除")])),_:2},1032,["onClick"])]),_:2},1024)):O("",!0)]),_:1},8,["columns","dataSource","loading","pagination"]),n.value?(r(),C(me,{key:0,modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=u=>n.value=u),onUpdate:b},null,8,["modelValue"])):O("",!0),l.value?(r(),C(fe,{key:1,modelValue:l.value,"onUpdate:modelValue":e[2]||(e[2]=u=>l.value=u),account:g.value,onUpdate:A},null,8,["modelValue","account"])):O("",!0)])}}},he=G(_e,[["__scopeId","data-v-a05707d2"]]);export{he as default};
