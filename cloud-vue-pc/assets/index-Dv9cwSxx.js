import{c as o,I as K,m as q,r as d,u as J,q as L,a as Q,d as C,o as u,e as t,j as $,l as ee,x as g,k as P,b as c,f as R,g as r,P as W,B as X,C as Y,n as M,A as z,h as E,E as te,v as ae,t as N,y as oe,M as le,G as ne}from"./index-DVWsMLSs.js";import{a as Z}from"./index-BUYeriUm.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useDayjs-25f8CHyX.js";import{u as se}from"./CloudDisk-CFN3zckg.js";import{h as ue}from"./index-CbH7X_L3.js";var re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"};function H(i){for(var n=1;n<arguments.length;n++){var l=arguments[n]!=null?Object(arguments[n]):{},m=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(m=m.concat(Object.getOwnPropertySymbols(l).filter(function(S){return Object.getOwnPropertyDescriptor(l,S).enumerable}))),m.forEach(function(S){de(i,S,l[S])})}return i}function de(i,n,l){return n in i?Object.defineProperty(i,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):i[n]=l,i}var G=function(n,l){var m=H({},n,l.attrs);return o(K,H({},m,{icon:re}),null)};G.displayName="MinusCircleOutlined";G.inheritAttrs=!1;const ce={__name:"AddAccModel",props:{modelValue:{},modelModifiers:{}},emits:q(["update"],["update:modelValue"]),setup(i,{emit:n}){const l=d(null),m=d(null),S=Z(m,l),y=J(i,"modelValue"),D=n,p=d(!1),I=d();L(()=>{});let f=Q({domains:[{account:"",password:""}]});const b=()=>{f.domains.push({account:"",password:""})},A=s=>{const v=f.domains.indexOf(s);v!==-1&&f.domains.splice(v,1)},x=()=>{p.value=!0,I.value.validate().then(async()=>{z.BatchUpdate({list:f.domains}).then(s=>{E.success("保存成功"),f.domains=[{account:"",password:""}],y.value=!1,D("update")}).finally(()=>{p.value=!1})}).catch(s=>{console.log("error",s),p.value=!1})},O=()=>{y.value=!1};return(s,v)=>{const a=c("a-input"),e=c("a-form-item"),k=c("a-col"),U=c("a-row"),h=c("a-form"),B=c("a-button"),w=c("a-modal");return u(),C(w,{maskClosable:!1,open:y.value,class:"ant-modal-dray",onCancel:O,width:"650px"},{title:t(()=>[R("div",{ref_key:"modalTitleRef",ref:l,class:"modal-title",style:{width:"100%",cursor:"move"}}," 添加云盘账号 ",512)]),modalRender:t(({originVNode:_})=>[R("div",{ref_key:"modalRef",ref:m,style:Y(g(S))},[(u(),C(X(_)))],4)]),footer:t(()=>[o(B,{type:"dashed",onClick:b},{default:t(()=>[o(g(W)),v[0]||(v[0]=r(" 添加云盘账号 "))]),_:1}),R("div",null,[o(B,{key:"back",onClick:O},{default:t(()=>v[1]||(v[1]=[r("取消")])),_:1}),o(B,{key:"submit",loading:p.value,type:"primary",onClick:x},{default:t(()=>v[2]||(v[2]=[r("保存")])),_:1},8,["loading"])])]),default:t(()=>[o(h,{ref_key:"formRef",ref:I,model:g(f)},{default:t(()=>[(u(!0),$(P,null,ee(g(f).domains,(_,T)=>(u(),C(U,{key:_.key},{default:t(()=>[o(k,{span:11},{default:t(()=>[o(e,{label:"账号",name:["domains",T,"account"],rules:{required:!0,message:"请输入云盘账号",trigger:"change"}},{default:t(()=>[o(a,{value:_.account,"onUpdate:value":V=>_.account=V,placeholder:"请输入云盘账号",style:{width:"150px","margin-right":"8px"}},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),o(k,{span:10},{default:t(()=>[o(e,{label:"密码",name:["domains",T,"password"],rules:{required:!0,message:"请输入云盘密码",trigger:"change"}},{default:t(()=>[o(a,{value:_.password,"onUpdate:value":V=>_.password=V,placeholder:"请输入云盘密码",style:{width:"150px","margin-right":"8px"},type:"password"},null,8,["value","onUpdate:value"]),g(f).domains.length>1?(u(),C(g(G),{key:0,class:"dynamic-delete-button",onClick:V=>A(_)},null,8,["onClick"])):M("",!0)]),_:2},1032,["name"])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["model"])]),_:1},8,["open"])}}},ie=F(ce,[["__scopeId","data-v-b475bf39"]]),me={__name:"EditAccModel",props:q({account:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:q(["update"],["update:modelValue"]),setup(i,{emit:n}){const l=d(null),m=d(null),S=Z(m,l),y=J(i,"modelValue"),D=n,p=i,I=d(!1),f=d();L(()=>{});let b=Q({account:p.account,password:""});const A=()=>{I.value=!0,f.value.validate().then(async()=>{z.BatchUpdate({list:[b]}).then(O=>{E.success("保存成功"),b={account:"",password:""},y.value=!1,D("update")}).finally(()=>{I.value=!1})}).catch(O=>{console.log("error",O),I.value=!1})},x=()=>{y.value=!1};return(O,s)=>{const v=c("a-input"),a=c("a-form-item"),e=c("a-form"),k=c("a-button"),U=c("a-modal");return u(),C(U,{maskClosable:!1,open:y.value,class:"ant-modal-dray",onCancel:x,width:"500px"},{title:t(()=>[R("div",{ref_key:"modalTitleRef",ref:l,class:"modal-title",style:{width:"100%",cursor:"move"}}," 编辑云盘账号 ",512)]),modalRender:t(({originVNode:h})=>[R("div",{ref_key:"modalRef",ref:m,style:Y(g(S))},[(u(),C(X(h)))],4)]),footer:t(()=>[o(k,{key:"back",onClick:x},{default:t(()=>s[2]||(s[2]=[r("取消")])),_:1}),o(k,{key:"submit",loading:I.value,type:"primary",onClick:A},{default:t(()=>s[3]||(s[3]=[r("保存")])),_:1},8,["loading"])]),default:t(()=>[o(e,{ref_key:"formRef",ref:f,model:g(b)},{default:t(()=>[o(a,{label:"账号",name:"account",rules:{required:!0,message:"请输入云盘账号",trigger:"change"}},{default:t(()=>[o(v,{value:g(b).account,"onUpdate:value":s[0]||(s[0]=h=>g(b).account=h),placeholder:"请输入云盘账号",disabled:"",style:{width:"150px","margin-right":"8px"}},null,8,["value"])]),_:1}),o(a,{label:"密码",name:"password",rules:{required:!0,message:"请输入云盘密码",trigger:"change"}},{default:t(()=>[o(v,{value:g(b).password,"onUpdate:value":s[1]||(s[1]=h=>g(b).password=h),placeholder:"请输入云盘密码",style:{width:"150px","margin-right":"8px"},type:"password"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])}}},pe=F(me,[["__scopeId","data-v-e738507b"]]),fe={class:"app-container"},ve={class:"table-top"},_e={__name:"index",setup(i){const n=d(!1),l=d(!1),m=d(""),S=se(),y=d(window.localStorage.getItem("account")),D=a=>{m.value=a.account,l.value=!0},p=d(!1),I=a=>{le.confirm({title:"删除确认",icon:o(ne),content:o("div",{style:"color:red;"},`是否要删除账号： ${a} ？`),okText:"删除",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk(){return p.value=!0,z.BatchDelete({list:[a]}).then(e=>{E.success("删除成功"),y.value==a&&(y.value="",window.localStorage.setItem("account",""),window.sessionStorage.setItem("cloud","")),x()}).catch(e=>{p.value=!1})},onCancel(){}})},f=d([]),b=d([{title:"序号",dataIndex:"serial"},{title:"账号",dataIndex:"account"},{title:"是否登录",dataIndex:"login"},{title:"更新时间",dataIndex:"update_time"},{title:"操作",dataIndex:"operate"}]),A=d({current:1,pageSize:1e3,total:0,showTotal:a=>`共计 ${a} 条`}),x=()=>{p.value=!0,z.getAccountList().then(a=>{a.length==1&&!a[0].cookies&&s(a[0].account),f.value=a.map(e=>({...e,account:ue(e.account)})),A.value.total=a.length}).finally(()=>{p.value=!1})},O=a=>{window.sessionStorage.setItem("cloud",a.cookies||""),window.localStorage.setItem("account",a.account),y.value=a.account,S.setCloudDiskUserInfo({account:a.account})},s=a=>{p.value=!0,z.cloudLogin({account:a}).then(e=>{O(e),E.success("登陆成功"),te(()=>{x()})}).finally(()=>{p.value=!1})},v=a=>{a.cookies?(O(a),E.success("切换成功")):s(a.account)};return L(()=>{x()}),(a,e)=>{const k=c("a-button"),U=c("a-space"),h=c("a-tag"),B=c("a-table");return u(),$("div",fe,[R("div",ve,[e[5]||(e[5]=R("div",null,null,-1)),o(U,null,{default:t(()=>[o(k,{type:"primary",onClick:x},{default:t(()=>e[3]||(e[3]=[r("刷新")])),_:1}),o(k,{icon:ae(g(W)),type:"primary",onClick:e[0]||(e[0]=w=>n.value=!0)},{default:t(()=>e[4]||(e[4]=[r("新增账号")])),_:1},8,["icon"])]),_:1})]),o(B,{columns:b.value,dataSource:f.value,loading:p.value,pagination:A.value},{bodyCell:t(({column:w,record:_,index:T,text:V})=>[w.dataIndex==="account"?(u(),$(P,{key:0},[r(N(V)+" ",1),V==y.value?(u(),C(h,{key:0,color:"green"},{default:t(()=>e[6]||(e[6]=[r("当前")])),_:1})):M("",!0)],64)):M("",!0),w.dataIndex==="serial"?(u(),$(P,{key:1},[r(N((A.value.current-1)*A.value.pageSize+T+1),1)],64)):M("",!0),w.dataIndex==="login"?(u(),$(P,{key:2},[_.cookies?(u(),C(h,{key:0,color:"green"},{default:t(()=>e[7]||(e[7]=[r("已登录")])),_:1})):(u(),C(h,{key:1,color:"red"},{default:t(()=>e[8]||(e[8]=[r("未登录")])),_:1}))],64)):M("",!0),w.dataIndex==="update_time"?(u(),$(P,{key:3},[r(N(g(oe)(V).fromNow()),1)],64)):M("",!0),w.dataIndex==="operate"?(u(),C(U,{key:4},{default:t(()=>[o(k,{onClick:j=>v(_)},{default:t(()=>e[9]||(e[9]=[r("切换")])),_:2},1032,["onClick"]),o(k,{onClick:j=>s(_.account)},{default:t(()=>e[10]||(e[10]=[r("登陆")])),_:2},1032,["onClick"]),o(k,{onClick:j=>D(_)},{default:t(()=>e[11]||(e[11]=[r("编辑")])),_:2},1032,["onClick"]),o(k,{onClick:j=>I(_.account)},{default:t(()=>e[12]||(e[12]=[r("删除")])),_:2},1032,["onClick"])]),_:2},1024)):M("",!0)]),_:1},8,["columns","dataSource","loading","pagination"]),n.value?(u(),C(ie,{key:0,modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=w=>n.value=w),onUpdate:x},null,8,["modelValue"])):M("",!0),l.value?(u(),C(pe,{key:1,modelValue:l.value,"onUpdate:modelValue":e[2]||(e[2]=w=>l.value=w),account:m.value,onUpdate:x},null,8,["modelValue","account"])):M("",!0)])}}},xe=F(_e,[["__scopeId","data-v-548da00f"]]);export{xe as default};
