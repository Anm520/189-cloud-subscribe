import{m as x,F as P,r as F,u as h,a as T,b as v,d as g,o as V,e as d,f as k,c as m,g as C,A as D,h as w,W as I,w as j,X as K,n as E,t as q,B as z,C as H,x as L}from"./index-DVWsMLSs.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as W,a as X}from"./index-BUYeriUm.js";const G={__name:"createFolderModel",props:x({parentFolderId:{type:[String,Number],default:""},folderName:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:x(["update:update"],["update:modelValue"]),setup(i,{emit:N}){const t=P.useForm,n=F(!1),l=h(i,"modelValue"),_=N,y=i,s=T({folderName:y.folderName}),o=T({folderName:[{required:!0,message:"请填写"}]}),{resetFields:c,validate:r,validateInfos:a}=t(s,o);F("");const{copy:e}=W({legacy:!0}),b=()=>{n.value=!0,r().then(()=>{console.log(s),console.log(" parentFolderId>>>",y.parentFolderId),D.createFolder({...s,parentFolderId:y.parentFolderId}).then(f=>{console.log("🚀 ~ API.renameFolder ~ res:",f),!y.folderName&&e(f.id).then(()=>{w.success("复制成功, 文件夹ID: "+f.id)}).catch(p=>{w.error("复制失败")}),w.success("创建成功"),_("update",f),l.value=!1}).finally(()=>{n.value=!1})}).catch(f=>{console.log("error",f),n.value=!1})},R=()=>{l.value=!1},u=f=>{console.log("Failed:",f)};return(f,p)=>{const O=v("a-input"),U=v("a-form-item"),A=v("a-form"),S=v("a-button"),B=v("a-modal");return V(),g(B,{open:l.value,"onUpdate:open":p[1]||(p[1]=M=>l.value=M),title:"新建文件夹"},{footer:d(()=>[m(S,{key:"back",onClick:R},{default:d(()=>p[2]||(p[2]=[C("取消")])),_:1}),m(S,{key:"submit",type:"primary",loading:n.value,onClick:b},{default:d(()=>p[3]||(p[3]=[C("确认")])),_:1},8,["loading"])]),default:d(()=>[k("div",null,[m(A,{model:s,name:"basic","label-col":{span:4},"wrapper-col":{span:16},autocomplete:"off",onFinish:b,onFinishFailed:u},{default:d(()=>[m(U,{label:"文件名",name:"folderName"},{default:d(()=>[m(O,{value:s.folderName,"onUpdate:value":p[0]||(p[0]=M=>s.folderName=M)},null,8,["value"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["open"])}}},J={__name:"FolderTree",props:x(K(["breadcrumb"],{breadcrumb:()=>[I]}),{modelValue:{default:()=>I},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const N=i.breadcrumb.map(o=>o.id),t=F(N),n=F([I]),l=h(i,"modelValue");function _(o){const c=o.dataRef;return D.getObjectFolderNodes({id:c.id,Cookie:document.cookie,noCache:Math.random()}).then(r=>{o.dataRef.children=r.map(a=>({...a,fullIds:[...c.fullIds,a.id],fullNames:[...c.fullNames,a.name]}))}).catch(r=>{o.dataRef.children=[]})}function y(o,{selected:c,selectedNodes:r,node:a,event:e}){console.log("selectedNodes>>>",a),l.value.id!==a.id&&(l.value=a),t.value.includes(a.id)?t.value=t.value.filter(b=>b!==a.id):t.value=[...t.value,a.id]}j(l,o=>{t.value=[...t.value,o]});function s(o,{expanded:c,node:r}){t.value=[...o]}return(o,c)=>{const r=v("a-directory-tree"),a=v("a-card");return V(),g(a,{class:"folder-tree"},{default:d(()=>[m(r,{expandedKeys:t.value,selectedKeys:[l.value.id],fieldNames:{children:"children",title:"name",key:"id"},"load-data":_,"tree-data":n.value,onExpand:s,onSelect:y},null,8,["expandedKeys","selectedKeys","tree-data"])]),_:1})}}},Q=$(J,[["__scopeId","data-v-123c839f"]]),Y={class:"footer-btn"},Z={__name:"FolderTreeModel",props:x(K(["breadcrumb","taskName"],{breadcrumb:()=>[I],taskName:""}),{modelValue:{default:!1},modelModifiers:{}}),emits:x(["ok"],["update:modelValue"]),setup(i,{emit:N}){const t=N,n=h(i,"modelValue"),l=F(I),_=F(!1),y=a=>{console.log("selectRow>>>>",l.value),n.value=!1,t("ok",l.value)},s=F(null),o=F(null),c=X(o,s),r=a=>{_.value=!1,n.value=!1,t("ok",a)};return(a,e)=>{const b=v("a-button"),R=v("a-modal");return V(),g(R,{open:n.value,"wrap-style":{overflow:"hidden"},class:"ant-modal-dray",onCancel:e[4]||(e[4]=u=>n.value=!1)},{title:d(()=>[k("div",{ref_key:"modalTitleRef",ref:s,class:"modal-title",style:{width:"100%",cursor:"move"}},"分享目录选择",512)]),modalRender:d(({originVNode:u})=>[k("div",{ref_key:"modalRef",ref:o,style:H(L(c))},[(V(),g(z(u)))],4)]),footer:d(()=>[k("div",Y,[m(b,{type:"primary",onClick:e[1]||(e[1]=u=>_.value=!0)},{default:d(()=>e[5]||(e[5]=[C("新建文件夹")])),_:1}),k("div",null,[m(b,{onClick:e[2]||(e[2]=u=>n.value=!1)},{default:d(()=>e[6]||(e[6]=[C("取消")])),_:1}),m(b,{type:"primary",onClick:y},{default:d(()=>e[7]||(e[7]=[C("确定")])),_:1})])])]),default:d(()=>[n.value?(V(),g(Q,{key:0,modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=u=>l.value=u),breadcrumb:i.breadcrumb},null,8,["modelValue","breadcrumb"])):E("",!0),k("div",null,"选中路径："+q(l.value.fullNames.join(" / ")),1),m(G,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=u=>_.value=u),parentFolderId:l.value.id,onUpdate:r,folderName:i.taskName},null,8,["modelValue","parentFolderId","folderName"])]),_:1},8,["open"])}}},oe=$(Z,[["__scopeId","data-v-a7cfbb23"]]);export{oe as F,G as _};
