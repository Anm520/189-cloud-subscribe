import{S as w,T as x,r as p,o as N,A as B,f as a,a as F,j as f,e as s,w as r,F as $,q as A,v as U,M as R,K as T,x as Q,L as j,_ as W,I as X,b as M,u as L,J as O}from"./index-C2vdb2pt.js";import{u as Y}from"./hooks-D1LR2YIV.js";const ne={__name:"ShareFileSelect",props:w({shareCode:{type:String,default:""},fileId:{type:String,default:""}},{modelValue:{default:!1,type:Boolean},modelModifiers:{}}),emits:w(["select"],["update:modelValue"]),setup(_,{emit:V}){const h=x(_,"modelValue"),v=_,y=V,b=p(v.fileId),g=p([]),C=p({shareId:"",shareMode:""}),i=n=>{const d=T({message:"加载中...",forbidClick:!0,duration:0}),c={noCache:Math.random(),...C.value,fileId:n,shareDirFileId:n,isFolder:!0,orderBy:"filename",descending:!1};B.getListShareDir(c).then(t=>{t.fileListAO&&t.fileListAO.folderList.length>0?g.value=t.fileListAO.folderList:Q({message:"没有更多文件了",duration:1e3})}).finally(()=>{j(d)})},m=()=>{h.value=!1},I=n=>{y("select",n),h.value=!1};return N(()=>{B.getShareInfoByCode({shareCode:v.shareCode}).then(n=>{console.log("getShareInfoByCode >>>>>:",n);const{shareMode:d,shareId:c,fileId:t,fileName:u}=n;C.value={shareId:c,shareMode:d},i(t)})}),(n,d)=>{const c=a("van-radio"),t=a("van-cell"),u=a("van-cell-group"),S=a("van-radio-group"),o=a("van-popup");return f(),F("div",null,[s(o,{show:h.value,round:"",position:"bottom",style:{height:"60%"},"safe-area-inset-top":"","safe-area-inset-bottom":"",onClickOverlay:m},{default:r(()=>[s(S,{modelValue:b.value,"onUpdate:modelValue":d[0]||(d[0]=e=>b.value=e),style:{"margin-top":"20px"}},{default:r(()=>[s(u,{inset:""},{default:r(()=>[(f(!0),F($,null,A(g.value,e=>(f(),U(t,{title:e.name,clickable:"",onClick:k=>i(e.id)},{"right-icon":r(()=>[s(c,{name:e.id,onClick:R(k=>I(e.id),["stop"])},null,8,["name","onClick"])]),_:2},1032,["title","onClick"]))),256))]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}},Z={style:{border:"1px solid #ccc"}},ee={__name:"FloderSelect",props:w({id:{type:[String,Number],default:""},name:{type:String,default:""}},{modelValue:{default:!1,type:Boolean},modelModifiers:{}}),emits:w(["select"],["update:modelValue"]),setup(_,{emit:V}){const h=p(null),v=x(_,"modelValue"),y=_,b=V,g=p(y.id),C=p([]),i=p({id:-11,name:"根目录",pId:-11}),m=X({}),I=o=>{o.id!=-11&&(o.parentId==-11?i.value={id:-11,name:"根目录",pId:-11}:i.value=m[o.pId],n(m[o.pId]))},n=o=>{const e=T({message:"加载中...",forbidClick:!0,duration:0});B.getObjectFolderNodes({id:o.id}).then(k=>{i.value=o,C.value=k||[],!m[o.id]&&(m[o.id]=o)}).finally(()=>{j(e)})},d=()=>{v.value=!1},c=o=>{b("select",o),v.value=!1},{showAddFolder:t,newFolderName:u,createFolderFn:S}=Y(i,o=>{c(o.id)});return u.value=y.name||"",N(()=>{n(i.value)}),(o,e)=>{const k=a("van-icon"),q=a("van-nav-bar"),D=a("van-radio"),P=a("van-cell"),z=a("van-cell-group"),E=a("van-radio-group"),G=a("van-field"),J=a("van-dialog"),K=a("van-popup");return f(),F("div",null,[s(K,{show:v.value,round:"",position:"bottom",style:{height:"80%"},"safe-area-inset-top":"","safe-area-inset-bottom":"",onClickOverlay:d},{default:r(()=>[M("div",{class:"van-popup-content",ref_key:"container",ref:h},[s(q,{title:i.value.name,"left-arrow":"",onClickLeft:e[1]||(e[1]=l=>I(i.value)),class:"van-nav-bar-top"},{right:r(()=>[s(k,{name:"plus",size:"18",onClick:e[0]||(e[0]=l=>t.value=!0)})]),_:1},8,["title"]),s(E,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=l=>g.value=l),class:"van-radio-group-content"},{default:r(()=>[s(z,{inset:""},{default:r(()=>[(f(!0),F($,null,A(C.value,l=>(f(),U(P,{title:l.name,clickable:"",onClick:H=>n(l)},{"right-icon":r(()=>[s(D,{name:l.id,onClick:R(H=>c(l.id),["stop"])},null,8,["name","onClick"])]),_:2},1032,["title","onClick"]))),256))]),_:1})]),_:1},8,["modelValue"]),s(J,{show:L(t),"onUpdate:show":e[4]||(e[4]=l=>O(t)?t.value=l:null),title:"新建文件夹","show-cancel-button":"","before-close":L(S)},{default:r(()=>[M("div",Z,[s(G,{modelValue:L(u),"onUpdate:modelValue":e[3]||(e[3]=l=>O(u)?u.value=l:null),label:"",placeholder:"输入文件夹名",required:"",autofocus:"",clearable:""},null,8,["modelValue"])])]),_:1},8,["show","before-close"])],512)]),_:1},8,["show"])])}}},te=W(ee,[["__scopeId","data-v-1045085c"]]);export{te as F,ne as _};
