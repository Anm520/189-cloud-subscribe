import{r as m,o as B,a as S,e as a,u as N,j as P,f as u,w as n,b as _,i,A as f,k as $,y as E}from"./index-idOx3MXX.js";import{u as I}from"./config-kjPOCiLx.js";import{U as j,e as A}from"./excel-l1Nrv32L.js";import"./_commonjsHelpers-Cpj98o6Y.js";const R={style:{margin:"16px"}},D={style:{margin:"16px"}},F={style:{margin:"16px"}},G={__name:"TimingSetting",setup(L){const t=m({is_execute:0,time_interval:"",ding_talk_token:"",tg_bot_token:"",tg_chat_id:"",wx_push_spt:"",chanel_url:"",qx_push_token:"",task_start_time:"",task_end_time:""}),p=m(!1),x=I(),r=m(!1),d=m("start"),V=({selectedValues:s})=>{console.log("val >>>>>:",s);let e=s.join(":");d.value==="start"?t.value.task_start_time=e:d.value==="end"&&(t.value.task_end_time=e),r.value=!1},b=s=>{p.value=!0,f.updateConfig(t.value).then(e=>{E({type:"success",message:"保存成功",duration:1e3}),t.value.chanel_url&&x.setChangelUrl(t.value.chanel_url),v.back()}).finally(()=>{p.value=!1})},y=()=>{A.exportToExcel([t.value],"定时配置.xlsx"),showRight.value=!1},w=s=>{t.value=s[0]},v=P(),C=()=>{f.getConfig().then(s=>{t.value=s[0]})};return B(()=>{C()}),(s,e)=>{const U=u("van-nav-bar"),k=u("van-radio"),c=u("van-radio-group"),o=u("van-field"),h=u("van-time-picker"),T=u("van-popup"),q=u("van-cell-group"),g=u("van-button"),z=u("van-form");return $(),S("div",null,[a(U,{title:"定时设置","left-arrow":"",onClickLeft:e[0]||(e[0]=l=>N(v).back())}),a(z,{onSubmit:b,required:"auto"},{default:n(()=>[a(q,{inset:""},{default:n(()=>[a(o,{name:"is_execute",label:"执行状态",rules:[{required:!0,message:"请选择执行状态"}]},{input:n(()=>[a(c,{modelValue:t.value.is_execute,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.is_execute=l),direction:"horizontal"},{default:n(()=>[a(k,{name:1},{default:n(()=>e[15]||(e[15]=[i("执行")])),_:1}),a(k,{name:0},{default:n(()=>e[16]||(e[16]=[i("暂停")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(o,{modelValue:t.value.task_start_time,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.task_start_time=l),readonly:"",name:"task_start_time",label:"执行开始时间",placeholder:"点击选择时间",onClick:e[3]||(e[3]=l=>{r.value=!0,d.value="start"}),rules:[{required:!0,message:"请填写执行开始时间"}]},null,8,["modelValue"]),a(o,{modelValue:t.value.task_end_time,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.task_end_time=l),readonly:"",name:"task_start_time",label:"执行结束时间",placeholder:"点击选择时间",onClick:e[5]||(e[5]=l=>{r.value=!0,d.value="end"}),rules:[{required:!0,message:"请填写执行结束时间"}]},null,8,["modelValue"]),a(T,{show:r.value,"onUpdate:show":e[7]||(e[7]=l=>r.value=l),position:"bottom"},{default:n(()=>[a(h,{title:"选择时间",onConfirm:V,onCancel:e[6]||(e[6]=l=>r.value=!1),"columns-type":["hour","minute","second"]})]),_:1},8,["show"]),a(o,{modelValue:t.value.time_interval,"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.time_interval=l),name:"time_interval",label:"执行间隔",placeholder:"执行间隔时间",type:"digit",rules:[{required:!0,message:"请填写执行间隔时间"}]},{"right-icon":n(()=>e[17]||(e[17]=[i(" 分钟 ")])),_:1},8,["modelValue"]),a(o,{modelValue:t.value.ding_talk_token,"onUpdate:modelValue":e[9]||(e[9]=l=>t.value.ding_talk_token=l),type:"textarea",name:"ding_talk_token",label:"钉钉机器人token",placeholder:"钉钉机器人token",rows:"2",autosize:""},null,8,["modelValue"]),a(o,{modelValue:t.value.qx_push_token,"onUpdate:modelValue":e[10]||(e[10]=l=>t.value.qx_push_token=l),type:"textarea",name:"qx_push_token",label:"企信机器人key",placeholder:"企信机器人key",rows:"2",autosize:""},null,8,["modelValue"]),a(o,{modelValue:t.value.wx_push_spt,"onUpdate:modelValue":e[11]||(e[11]=l=>t.value.wx_push_spt=l),type:"textarea",name:"wx_push_spt",label:"WXPushSpt",placeholder:"wx_push_spt",rows:"1",autosize:""},null,8,["modelValue"]),a(o,{modelValue:t.value.tg_bot_token,"onUpdate:modelValue":e[12]||(e[12]=l=>t.value.tg_bot_token=l),type:"textarea",name:"tg_bot_token",label:"TgBotToken",placeholder:"TgBotToken",rows:"1",autosize:""},null,8,["modelValue"]),a(o,{modelValue:t.value.tg_chat_id,"onUpdate:modelValue":e[13]||(e[13]=l=>t.value.tg_chat_id=l),type:"textarea",name:"tg_chat_id",label:"TgChatId",placeholder:"TgChatId",rows:"1",autosize:""},null,8,["modelValue"]),a(o,{modelValue:t.value.chanel_url,"onUpdate:modelValue":e[14]||(e[14]=l=>t.value.chanel_url=l),type:"textarea",name:"chanel_url",label:"频道地址",placeholder:"例：http://127.0.0.1:3001",rows:"1",autosize:""},null,8,["modelValue"])]),_:1}),_("div",R,[a(g,{block:"",type:"primary","native-type":"submit",loading:p.value},{default:n(()=>e[18]||(e[18]=[i(" 提交 ")])),_:1},8,["loading"])]),_("div",D,[a(g,{block:"",type:"primary",onClick:y},{default:n(()=>e[19]||(e[19]=[i(" 导出配置 ")])),_:1})]),_("div",F,[a(j,{onOk:w,type:"btn",title:"导入配置",style:{width:"100%"}})])]),_:1})])}}};export{G as default};
